<div class="app-container">
  <app-head-bar></app-head-bar>
  
  <app-search-bar 
    [autos]="autoList"
    (selectAutoEvent)="updateAuto($event)">
  </app-search-bar>

  <div class="gallery-container" *ngIf="autoList && autoList.length">
    <h2 class="gallery-title">Nos véhicules disponibles</h2>

    <div class="brand-sections">
      <section *ngFor="let group of groupedAutos" class="brand-section">
        <div class="brand-header">
          <h3>{{ group.marque }}</h3>
          <div class="brand-count">{{ group.autos.length }} modèle(s)</div>
        </div>
        <div class="brand-grid">
          <div *ngFor="let auto of group.autos; let i = index" class="car-card" [style.animationDelay]="i * 0.04 + 's'">
            <div class="card-image">
              <img [src]="auto.photo" [alt]="auto.modele" />
            </div>
            <div class="card-body">
              <div class="card-head">
                <div class="card-brand">{{ auto.marque }}</div>
                <div class="card-availability" [class.low-stock]="auto.disponibilite <= 3">{{ auto.disponibilite }} en stock</div>
              </div>
              <h3 class="card-model">{{ auto.modele }}</h3>
              <div class="card-specs">
                <span class="spec-power">{{ auto.puissance }} CV</span>
                <span class="spec-price">{{ formatPrice(auto.prix) }}</span>
              </div>
              <div class="card-actions">
                <button class="card-btn" (click)="updateAuto(auto)">Voir</button>
              </div>
            </div>
          </div>
        </div>
      </section>
    </div>
  </div>

  <div class="details-container" *ngIf="selectedAuto">
    <button class="close-details" (click)="closeDetails()">
      <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
        <line x1="18" y1="6" x2="6" y2="18"></line>
        <line x1="6" y1="6" x2="18" y2="18"></line>
      </svg>
    </button>
    
    <div class="details-header">
      <div class="brand-logo">{{ selectedAuto.marque }}</div>
      <h2>{{ selectedAuto.modele }}</h2>
    </div>

    <div class="auto-details">
      <div class="auto-image-section">
        <div class="auto-image">
          <img [src]="selectedAuto.photo" [alt]="selectedAuto.modele" />
        </div>
      </div>

      <div class="auto-info-section">
        <h3 class="section-title">
          <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
            <path d="M14.5 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7.5L14.5 2z"></path>
            <polyline points="14 2 14 8 20 8"></polyline>
          </svg>
          Caractéristiques techniques
        </h3>
        
        <div class="auto-info">
          <div class="info-row">
            <div class="info-label">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M3 3h18v18H3zM21 9H3M21 15H3M12 3v18"></path>
              </svg>
              <span>Marque</span>
            </div>
            <div class="info-value">{{ selectedAuto.marque }}</div>
          </div>

          <div class="info-row">
            <div class="info-label">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M19 17h2c.6 0 1-.4 1-1v-3c0-.9-.7-1.7-1.5-1.9C18.7 10.6 16 10 16 10s-1.3-1.4-2.2-2.3c-.5-.4-1.1-.7-1.8-.7H5c-.6 0-1.1.4-1.4.9l-1.4 2.9A3.7 3.7 0 0 0 2 12v4c0 .6.4 1 1 1h2"></path>
                <circle cx="7" cy="17" r="2"></circle>
                <path d="M9 17h6"></path>
                <circle cx="17" cy="17" r="2"></circle>
              </svg>
              <span>Modèle</span>
            </div>
            <div class="info-value">{{ selectedAuto.modele }}</div>
          </div>

          <div class="info-row highlight">
            <div class="info-label">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <line x1="12" y1="1" x2="12" y2="23"></line>
                <path d="M17 5H9.5a3.5 3.5 0 0 0 0 7h5a3.5 3.5 0 0 1 0 7H6"></path>
              </svg>
              <span>Prix</span>
            </div>
            <div class="info-value price-value">{{ selectedAuto.prix.toLocaleString() }} DT</div>
          </div>

          <div class="info-row">
            <div class="info-label">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <polyline points="23 6 13.5 15.5 8.5 10.5 1 18"></polyline>
                <polyline points="17 6 23 6 23 12"></polyline>
              </svg>
              <span>Puissance</span>
            </div>
            <div class="info-value">{{ selectedAuto.puissance }} CV</div>
          </div>

          <div class="info-row" [class.low-stock]="selectedAuto.disponibilite <= 3">
            <div class="info-label">
              <svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M20 7h-9"></path>
                <path d="M14 17H5"></path>
                <circle cx="17" cy="17" r="3"></circle>
                <circle cx="7" cy="7" r="3"></circle>
              </svg>
              <span>Disponibilité</span>
            </div>
            <div class="info-value">
              {{ selectedAuto.disponibilite }} unité(s)
              <span class="stock-badge" *ngIf="selectedAuto.disponibilite <= 3">Stock limité</span>
            </div>
          </div>
        </div>

        <div class="action-buttons">
          <button class="btn-primary">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <circle cx="9" cy="21" r="1"></circle>
              <circle cx="20" cy="21" r="1"></circle>
              <path d="M1 1h4l2.68 13.39a2 2 0 0 0 2 1.61h9.72a2 2 0 0 0 2-1.61L23 6H6"></path>
            </svg>
            <span>Commander maintenant</span>
          </button>
          <button class="btn-secondary">
            <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M20.84 4.61a5.5 5.5 0 0 0-7.78 0L12 5.67l-1.06-1.06a5.5 5.5 0 0 0-7.78 7.78l1.06 1.06L12 21.23l7.78-7.78 1.06-1.06a5.5 5.5 0 0 0 0-7.78z"></path>
            </svg>
            <span>Ajouter aux favoris</span>
          </button>
        </div>
      </div>
    </div>
  </div>
</div>